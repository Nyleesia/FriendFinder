<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <!-- Style CDNs -->
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css" integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous">
    <!-- Additional CSS -->
    <link rel="stylesheet" type="text/css" href="/app/public/style.css"/>
    <!-- jQuery -->
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>
    <title>Survey</title>
</head>
<body>
    <!-- Page container -->
    <div class = "container">

            <!-- Jumbotron -->
            <div class = "jumbotron">
                <!-- Jumbotron titles-->
                <div class = "jumboTitles"><h1>Welcome to Friend Finder!</h1></div>
                <hr />
                <div class = "jumboTitles"><h2>Answer our survey and find a similar friend!</h2></div>
                <!-- Jumbotron titles ends-->
            </div><!-- Jumbotron ends -->
            <hr />

            <!-- Survey card -->
            <div class = "card" id ="survey"> 

                <!-- Survey card heading -->
                <h2 class = "heading">Survey Questions</h2>
                <hr /> <!-- Survey card heading ends -->

                <!-- Survey card questions about you -->
                <h3 class = "aboutHead">About You</h3>
                <hr /> 
                <h4 class = "questionsAbout">Name (required):</h4>
                <h4 class = "questionsAbout">Photo (required):</h4>
                <hr /> <!-- Survey card questions about you ends -->
                
                <ul> <!-- Survey card questions main -->
                    <!-- Q1 -->
                    <li><h3 class = "questionsMain"> I am a reserved person. 
                        <select data-placeholder= ""  class = "chosen-select" name="" id="q1">
                            <option value=""></option>
                            <option value="1">1 (Strongly Disagree)</option>
                            <option value="2">2 (Disagree)</option>
                            <option value="3">3 (Slightly Disagree) </option>
                            <option value="4">4 (Neutral)</option>
                            <option value="5">5 (Slightly Agree)</option>
                            <option value="6">6 (Agree)</option>
                            <option value="7">7 (Strongly Agree)</option>
                        </select> 
                    </h3></li><!-- Q1 ends -->

                    <!-- Q2 -->
                    <li><h3 class = "questionsMain"> I trust other people.
                        <select data-placeholder= ""  class = "chosen-select" name="" id="q2">  
                            <option value=""></option>
                            <option value="1">1 (Strongly Disagree)</option>
                            <option value="2">2 (Disagree)</option>
                            <option value="3">3 (Slightly Disagree) </option>
                            <option value="4">4 (Neutral)</option>
                            <option value="5">5 (Slightly Agree)</option>
                            <option value="6">6 (Agree)</option>
                            <option value="7">7 (Strongly Agree)</option>
                        </select> 
                    </h3></li><!-- Q2 ends -->

                    <!-- Q3 -->
                    <li><h3 class = "questionsMain"> I tend to be lazy. 
                        <select data-placeholder= ""  class = "chosen-select" name="" id="q3">  
                            <option value=""></option>
                            <option value="1">1 (Strongly Disagree)</option>
                            <option value="2">2 (Disagree)</option>
                            <option value="3">3 (Slightly Disagree) </option>
                            <option value="4">4 (Neutral)</option>
                            <option value="5">5 (Slightly Agree)</option>
                            <option value="6">6 (Agree)</option>
                            <option value="7">7 (Strongly Agree)</option>
                        </select> 
                        </h3></li><!-- Q3 ends -->

                    <!-- Q4 -->
                    <li><h3 class = "questionsMain"> I am generally relaxed, not stressed.
                        <select data-placeholder= ""  class = "chosen-select" name="" id="q4">  
                            <option value=""></option>
                            <option value="1">1 (Strongly Disagree)</option>
                            <option value="2">2 (Disagree)</option>
                            <option value="3">3 (Slightly Disagree) </option>
                            <option value="4">4 (Neutral)</option>
                            <option value="5">5 (Slightly Agree)</option>
                            <option value="6">6 (Agree)</option>
                            <option value="7">7 (Strongly Agree)</option>
                        </select> 
                    </h3></li><!-- Q4 ends -->

                    <!-- Q5 -->
                    <li><h3 class = "questionsMain">I have few artistic interests. 
                        <select data-placeholder= ""  class = "chosen-select" name="" id="q5">  
                            <option value=""></option>
                            <option value="1">1 (Strongly Disagree)</option>
                            <option value="2">2 (Disagree)</option>
                            <option value="3">3 (Slightly Disagree) </option>
                            <option value="4">4 (Neutral)</option>
                            <option value="5">5 (Slightly Agree)</option>
                            <option value="6">6 (Agree)</option>
                            <option value="7">7 (Strongly Agree)</option>
                        </select> 
                    </h3></li><!-- Q5 ends -->

                    <!-- Q6 -->
                    <li><h3 class = "questionsMain"> I am sociable.
                        <select data-placeholder= ""  class = "chosen-select" name="" id="q6">
                            <option value=""></option>
                            <option value="1">1 (Strongly Disagree)</option>
                            <option value="2">2 (Disagree)</option>
                            <option value="3">3 (Slightly Disagree) </option>
                            <option value="4">4 (Neutral)</option>
                            <option value="5">5 (Slightly Agree)</option>
                            <option value="6">6 (Agree)</option>
                            <option value="7">7 (Strongly Agree)</option>
                        </select> 
                    </h3></li><!-- Q6 ends -->

                        <!-- Q7 -->
                        <li><h3 class = "questionsMain"> I tend to find fault with others.
                        <select data-placeholder= ""  class = "chosen-select" name="" id="q7"> 
                            <option value=""></option>
                            <option value="1">1 (Strongly Disagree)</option>
                            <option value="2">2 (Disagree)</option>
                            <option value="3">3 (Slightly Disagree) </option>
                            <option value="4">4 (Neutral)</option>
                            <option value="5">5 (Slightly Agree)</option>
                            <option value="6">6 (Agree)</option>
                            <option value="7">7 (Strongly Agree)</option>
                        </select> 
                    </h3></li><!-- Q7 ends -->

                        <!-- Q8 -->
                        <li><h3 class = "questionsMain"> I do my job well.
                        <select data-placeholder= ""  class = "chosen-select" name="" id="q8"> 
                            <option value=""></option>
                            <option value="1">1 (Strongly Disagree)</option>
                            <option value="2">2 (Disagree)</option>
                            <option value="3">3 (Slightly Disagree) </option>
                            <option value="4">4 (Neutral)</option>
                            <option value="5">5 (Slightly Agree)</option>
                            <option value="6">6 (Agree)</option>
                            <option value="7">7 (Strongly Agree)</option>
                        </select> 
                        </h3></li><!-- Q8 ends -->

                    <!-- Q9 -->
                    <li><h3 class = "questionsMain"> I get nervous easily.
                        <select data-placeholder= ""  class = "chosen-select" name="" id="q9"> 
                            <option value=""></option>
                            <option value="1">1 (Strongly Disagree)</option>
                            <option value="2">2 (Disagree)</option>
                            <option value="3">3 (Slightly Disagree) </option>
                            <option value="4">4 (Neutral)</option>
                            <option value="5">5 (Slightly Agree)</option>
                            <option value="6">6 (Agree)</option>
                            <option value="7">7 (Strongly Agree)</option>
                        </select> 
                    </h3></li><!-- Q9 ends -->

                    <!-- Q10 -->
                    <li><h3 class = "questionsMain"> I have an active imagination.
                        <select data-placeholder= ""  class = "chosen-select" name="" id="q10"> 
                            <option value=""></option>
                            <option value="1">1 (Strongly Disagree)</option>
                            <option value="2">2 (Disagree)</option>
                            <option value="3">3 (Slightly Disagree) </option>
                            <option value="4">4 (Neutral)</option>
                            <option value="5">5 (Slightly Agree)</option>
                            <option value="6">6 (Agree)</option>
                            <option value="7">7 (Strongly Agree)</option>
                        </select> 
                    </h3></li><!-- Q10 ends -->
                </ul> <!-- Survey card questions main ends -->
                <br />
                </div> <!-- Survey card ends -->
                <br />
            </div> <!-- Page container ends-->
            <hr />
            <!-- Survey submit button -->
            <button type="submit" class="btn btn-primary btn-lg btn-block" id = "submit"><i class="fa fa-check-circle" aria-hidden="true"></i> Submit
          </button> <!-- Survey submit button ends-->
          <br />
          <br />

    <!-- Footer -->
    <footer>
            <h4> DISCLAIMER:</h4>

                    <h5>This app uses the BFI-10 to compare personalities and infer similarities, based on user responses to the survey items. This application does not claim to be able to assess user compatibility.
    
                    Please be aware that entering your name, uploading a photo and clicking on the survey button indicate your autonomous willingness and informed consent to participate in this assessment. 
    
                    Due to the fact that this assessment is not being clinically administered, it is not recommended that it be used for making life-changing decisions, or for medical, or theraputic purposes. This application should be used ONLY for the amusement of user(s).</h5>
    
                    <h6>Adapted from: Rammstedt, B. & John, O.P. (2007). Measuring personality in one minute or less: A 10-item short version of  the Big Five Inventory in English and German. Journal of Research in Personality, 41, 203–212. </h6>
        </footer> <!-- Footer ends --> 

        <!-- Results modal ends -->
        <div id="resultsModal" class= "modal fade" role="dialog">
            <!-- Dialog modal -->
            <div class = "modal-dialog">
                <!-- Modal content -->
                <div  class = "modal-content">
                    <!-- Modal header -->
                    <div  class = "modal-header">
                        <button type = "button" class = "close" data-dismiss = "modal"> &times;
                        </button>
                        <h2 class = "modal-title"><strong> Best Match</strong></h2>
                    </div><!-- Modal header ends -->
                    <!-- Modal body -->
                    <div class = "modal-body">
                        <h2 id = "matchName"></h2>
                        <img id = "matchImg" src="" alt="User does not have a photo, or it could not be loaded"/>
                    </div><!-- Modal body ends -->
                    <!-- Modal footer -->
                    <div class = "modal-footer">
                        <button type = "button" class = "btn btn-default" data-dismiss = "modal">Close
                        </button>
                    </div>  <!-- Modal footer ends-->
                </div><!-- Modal content ends -->
            </div><!-- Dialog modal ends -->
        </div> <!-- Results modal ends -->

        <script type = "text/javascript" >
            $("#submit").on("click", function(){
                function validateForm() {
                    let isValid = true; 
                    $(".form-control").each(function (){
                        if ($(this).val() === "") isValid = false
                    });
                    $(".chosen-select").each(function (){
                        if ($(this).val() === "") isValid = false
                
                    });
                    return isValid;
                }

                if (validateForm()==true){
                    var userData = {
                        name: $("name").val(),
                        photo: $("photo").val(),
                        scores:[
                            $("#q1").val(),
                            $("#q2").val(),
                            $("#q3").val(),
                            $("#q4").val(),
                            $("#q5").val(),
                            $("#q6").val(),
                            $("#q7").val(),
                            $("#q8").val(),
                            $("#q9").val(),
                            $("#q10").val()
                        ]
                    }; 

                    var currentURL = window.location.origin;

                    $.post(currentURL + "/api/friends", userData, function (data){
                        $("#matchName").text(data.name);
                        $("#matchImg").attr("src", data.photo);
                        $("#resultsModal").modal("toggle");
                    })
                }
                else {
                    alert(`Please ensure that all fields have been filled before submitting!`)
                }
                return false;
            })
        </script>

    </body>
    </html>